# プロジェクトメタデータ
project:
  name: monolog/monolog
  php_min_version: "8.1"
  source_counts:
    src_php: 121
    tests_php: 94
  tooling:
    php_cs_fixer_config: .php-cs-fixer.php
    phpstan_config: phpstan.neon.dist
    phpunit_config: phpunit.xml.dist

# ルール定義リスト
rules:
  - id: declare_strict_types
    category: syntax
    source: .php-cs-fixer.php
    description: "全 PHP ファイルで strict_types を宣言する"
    verification:
      command: "grep -Rl 'declare(strict_types=1);' monolog/src"
      result:
        matches: 121
        total: 121
    severity: high
    scoring_weight: 10
    example_pass: "Monolog\\Logger"
    example_fail: null
    notes: "tests ディレクトリ（94ファイル）も同様に遵守"

  - id: array_syntax_short
    category: formatting
    source: .php-cs-fixer.php
    description: "配列は短縮構文 [] を使用し、複数行時は末尾カンマを付与する"
    verification:
      command: "php scripts/check-array-syntax.php --path=monolog/src"
      result:
        violations: []
    severity: medium
    scoring_weight: 6
    example_pass: "Monolog\\Handler\\StreamHandler"
    example_fail: null
    notes: "単一行配列の末尾カンマ禁止 (no_trailing_comma_in_singleline_array)"

  - id: phpstan_level8_clean
    category: static_analysis
    source: phpstan.neon.dist
    description: "phpstan level 8 + strict/deprecation をエラーゼロで通過する"
    verification:
      command: "vendor/bin/phpstan analyse --error-format=json"
      result:
        errors: 0
    severity: high
    scoring_weight: 12
    example_pass: "全体"
    example_fail: null
    notes: "treatPhpDocTypesAsCertain=false を踏まえ、DocBlock の型精度に注意"

# 評価設定
scoring:
  total_points: 100
  rubric:
    syntax: 30
    formatting: 20
    static_analysis: 20
    readability: 15
    maintainability: 15

# 参考情報
references:
  - path: monolog/.php-cs-fixer.php
    type: config
  - path: monolog/phpstan.neon.dist
    type: config
  - path: monolog/src/Monolog/Logger.php
    type: code

